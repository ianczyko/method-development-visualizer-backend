name: ubuntu-cmake-compile-and-test

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Installing Boost and python3-dev
      run: sudo apt-get update && sudo apt-get install libboost-all-dev python3-dev
    - name: Create build catalog
      run: cd methodDevelopment ; mkdir build ; cd build
    - name: Run CMake
      working-directory: ./methodDevelopment/build
      run: cmake -D TEST:BOOL=TRUE -D ENABLE_COVERAGE:BOOL=TRUE ..
    - name: Run make
      working-directory: ./methodDevelopment/build
      run: make
    - name: Run tests
      working-directory: ./methodDevelopment/build
      run: ./tester
    - name: Remove redundant data
      working-directory: ./methodDevelopment/build
      run: rm -rf CMakeFiles/tester.dir/tests
    - name: Upload the results
      working-directory: ./methodDevelopment/build
      run: bash <(curl -s https://codecov.io/bash)

